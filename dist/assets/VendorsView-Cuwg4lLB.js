import{d as te,u as le,$ as ae,E as I,o as oe,c as s,e as t,g as d,h as ne,x as G,f as re,p,v as m,q as y,t as i,F as O,z as P,G as se,w as ie,P as de,r as x,i as $,L as U,K as ue,k as _e,j as r,a0 as ve,_ as ce}from"./index-oHQmfbVN.js";import{_ as v}from"./Skeleton.vue_vue_type_script_setup_true_lang-Lbwj0Rap.js";const pe={class:"content-area flex flex-col flex-1 min-h-0 w-full max-w-[1600px] mx-auto px-4 py-5 md:px-6 md:py-6"},me={class:"flex flex-wrap items-center justify-between gap-4 mb-6"},xe={class:"flex flex-wrap items-center gap-3"},be={key:0,class:"tax-search-bar"},he={class:"tax-search-bar__row"},fe={key:0,class:"tax-search-bar__hint"},ge={class:"tax-table-wrap"},Ve={key:0,class:"tax-table-skeleton"},ye={class:"tax-table-skeleton__search"},ke={class:"tax-table"},we={class:"tax-table__actions-th"},De={class:"tax-table__actions-td"},Ee={key:1,class:"tax-table-error"},Te={key:2,class:"tax-table-empty"},Ne={key:3,class:"tax-table-empty"},Re={key:4},Ce={class:"tax-table-scroll"},Le={class:"tax-table"},Me={class:"tax-table__actions-td"},He=["onClick"],Se={key:0,class:"pagination"},Ie=["disabled"],We={class:"pagination__label"},Ae=["disabled"],Be={key:0,class:"tax-modal-backdrop"},Ge=["aria-labelledby"],$e={class:"tax-modal__header"},Ue=["id"],je={key:0,class:"tax-modal__error",role:"alert"},Fe={class:"tax-modal__error-text"},ze={class:"tax-modal__section"},Oe={class:"tax-modal__label"},Pe={class:"tax-modal__label"},qe={class:"tax-modal__label"},Ke={class:"tax-modal__label"},Qe={class:"tax-modal__label"},Ye={class:"tax-modal__section"},Ze={class:"tax-modal__row"},Je={class:"tax-modal__label"},Xe={class:"tax-modal__label"},et={class:"tax-modal__row"},tt={class:"tax-modal__label"},lt={class:"tax-modal__label"},at={class:"tax-modal__actions"},ot=["disabled"],j=10,nt=te({__name:"VendorsView",setup(rt){const{createRecord:q,updateRecord:K,findRecordsWithIds:Q,isConnected:W}=_e(),f=le(),F=ae(),g=x([]),w=x(!0),D=x(null),k=x(!1),u=x(""),c=x(null),o=x({Vendor_ID:"",Vendor_Name:"",Vendor_Location:"",Vendor_Email:"",GRA_Expiry_Date:"",Received_Date:"",Tin_Number:"",WHT_Expiry_Date:"",Received_WHT_Date:""}),b=x(null),E=x(!1);function V(a,e){const n=a.fieldData,l=n[e]??n[e.replace(/_/g," ")];return l==null||l===""?"—":String(l).trim()}const T=$(()=>{const a=u.value.toLowerCase();return a?g.value.filter(e=>{const n=e.fieldData,l=String(n.Vendor_ID??n["Vendor ID"]??"").toLowerCase(),h=String(n.Vendor_Name??n["Vendor Name"]??"").toLowerCase(),R=String(n.Vendor_Location??n["Vendor Location"]??"").toLowerCase(),H=String(n.Vendor_Email??n["Vendor Email"]??"").toLowerCase(),S=String(n.Tin_Number??n["Tin Number"]??"").toLowerCase();return l.includes(a)||h.includes(a)||R.includes(a)||H.includes(a)||S.includes(a)}):g.value}),_=x(1),N=$(()=>Math.max(1,Math.ceil(T.value.length/j))),Y=$(()=>{const a=(_.value-1)*j;return T.value.slice(a,a+j)});I(u,()=>{_.value=1}),I(N,a=>{_.value>a&&(_.value=Math.max(1,a))});function z(a){return a!=null&&a.trim()?a.trim():"—"}function L(a){if(!(a!=null&&a.trim()))return"";const e=a.trim(),n=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/.exec(e);if(n){const l=n[1].padStart(2,"0"),h=n[2].padStart(2,"0");return`${n[3]}-${l}-${h}`}return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:""}function M(a){return ve(a)}function A(){k.value=!1,c.value=null}function Z(){c.value=null,o.value={Vendor_ID:"",Vendor_Name:"",Vendor_Location:"",Vendor_Email:"",GRA_Expiry_Date:"",Received_Date:"",Tin_Number:"",WHT_Expiry_Date:"",Received_WHT_Date:""},b.value=null}function J(a){const e=a.fieldData;o.value={Vendor_ID:String(e.Vendor_ID??e["Vendor ID"]??""),Vendor_Name:String(e.Vendor_Name??e["Vendor Name"]??""),Vendor_Location:String(e.Vendor_Location??e["Vendor Location"]??""),Vendor_Email:String(e.Vendor_Email??e["Vendor Email"]??""),GRA_Expiry_Date:L(e.GRA_Expiry_Date??e["GRA Expiry Date"]),Received_Date:L(e.Received_Date??e["Received Date"]),Tin_Number:String(e.Tin_Number??e["Tin Number"]??""),WHT_Expiry_Date:L(e.WHT_Expiry_Date??e["WHT Expiry Date"]),Received_WHT_Date:L(e.Received_WHT_Date??e["Received WHT Date"])},c.value=a.recordId,b.value=null,k.value=!0}I(k,a=>{a||(c.value=null)});function X(){var a;return(a=o.value.Vendor_Name)!=null&&a.trim()?null:"Vendor Name is required."}async function ee(){var n,l,h,R,H;if(E.value)return;if(!W.value){f.error("Not connected to FileMaker."),b.value=null;return}const a=X();if(a){f.error(a),b.value=null;return}E.value=!0,b.value=null;const e=c.value?String(c.value).trim():null;try{const S={Vendor_ID:((n=o.value.Vendor_ID)==null?void 0:n.trim())||void 0,Vendor_Name:(l=o.value.Vendor_Name)==null?void 0:l.trim(),Vendor_Location:((h=o.value.Vendor_Location)==null?void 0:h.trim())||void 0,Vendor_Email:((R=o.value.Vendor_Email)==null?void 0:R.trim())||void 0,GRA_Expiry_Date:M(o.value.GRA_Expiry_Date),Received_Date:M(o.value.Received_Date),Tin_Number:((H=o.value.Tin_Number)==null?void 0:H.trim())||void 0,WHT_Expiry_Date:M(o.value.WHT_Expiry_Date),Received_WHT_Date:M(o.value.Received_WHT_Date)};if(e){const{error:C}=await K(U.VENDOR_TBL,e,S);if(C){f.error(C),b.value=null;return}f.success("Vendor updated successfully.")}else{const{error:C}=await q(U.VENDOR_TBL,S);if(C){f.error(C),b.value=null;return}f.success("Vendor added successfully.")}A(),Z(),await B()}finally{E.value=!1}}async function B(){if(!W.value){g.value=[],w.value=!1;return}w.value=!0,D.value=null;const{data:a,error:e}=await Q(U.VENDOR_TBL,{limit:500});w.value=!1,e?(f.error(e),D.value=null,g.value=[],F.setVendorCount(0)):(g.value=a,F.setVendorCount(a.length))}return oe(B),I(W,a=>{a&&B()}),(a,e)=>{const n=ue("router-link");return r(),s("div",pe,[t("header",me,[t("div",xe,[d(n,{to:"/",class:"pill-btn glass-input inline-flex items-center gap-1.5 px-3 py-2 text-[var(--label-size)] text-[var(--color-text-muted)] no-underline hover:text-[var(--color-text)]"},{default:ne(()=>[...e[16]||(e[16]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),G(" Back ",-1)])]),_:1}),e[17]||(e[17]=t("h1",{class:"text-xl font-bold tracking-tight text-[var(--color-text)]"}," Vendors ",-1))]),t("button",{type:"button",class:"pill-btn inline-flex items-center gap-2 rounded-full bg-orange-500 px-4 py-2.5 text-[var(--label-size)] font-semibold text-white shadow-md hover:bg-orange-600 transition-colors",onClick:e[0]||(e[0]=l=>k.value=!0)},[...e[18]||(e[18]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),G(" Add Vendor ",-1)])])]),e[39]||(e[39]=t("p",{class:"text-[var(--label-size)] text-[var(--color-text-muted)] mb-4"}," Manage vendors here. View, add, and edit vendor details. ",-1)),!w.value&&!D.value&&g.value.length>0?(r(),s("div",be,[t("div",he,[t("div",{class:re(["search-bar__wrap tax-search-bar__search",{"search-bar__wrap--has-value":u.value}])},[e[20]||(e[20]=t("span",{class:"search-bar__icon","aria-hidden":"true"},[t("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",viewBox:"0 0 24 24"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),type:"search",class:"search-bar__input",placeholder:"Search vendors…",autocomplete:"off","aria-label":"Search vendors"},null,512),[[m,u.value,void 0,{trim:!0}]]),u.value?(r(),s("button",{key:0,type:"button",class:"search-bar__clear","aria-label":"Clear search",onClick:e[2]||(e[2]=l=>u.value="")},[...e[19]||(e[19]=[t("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2.5",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):y("",!0)],2)]),u.value?(r(),s("p",fe,i(T.value.length)+" result"+i(T.value.length===1?"":"s"),1)):y("",!0)])):y("",!0),t("div",ge,[w.value?(r(),s("div",Ve,[t("div",ye,[d(v,{width:"100%",height:"2.75rem",class:"rounded-xl"})]),t("table",ke,[t("thead",null,[t("tr",null,[t("th",null,[d(v,{width:"5rem",height:"0.875rem",class:"rounded"})]),t("th",null,[d(v,{width:"6rem",height:"0.875rem",class:"rounded"})]),t("th",null,[d(v,{width:"4rem",height:"0.875rem",class:"rounded"})]),t("th",null,[d(v,{width:"4.5rem",height:"0.875rem",class:"rounded"})]),t("th",we,[d(v,{width:"2.5rem",height:"0.875rem",class:"rounded"})])])]),t("tbody",null,[(r(),s(O,null,P(6,l=>t("tr",{key:l,class:"tax-table-skeleton__row"},[t("td",null,[d(v,{width:"4rem",height:"0.875rem",class:"rounded"})]),t("td",null,[d(v,{width:"70%",height:"0.875rem",class:"rounded max-w-[8rem]"})]),t("td",null,[d(v,{width:"5rem",height:"0.875rem",class:"rounded"})]),t("td",null,[d(v,{width:"4rem",height:"0.875rem",class:"rounded"})]),t("td",De,[d(v,{width:"3.5rem",height:"1.75rem",class:"rounded-lg"})])])),64))])])])):D.value?(r(),s("div",Ee,i(D.value),1)):g.value.length===0?(r(),s("div",Te,[e[21]||(e[21]=t("p",null,"No vendors yet.",-1)),t("button",{type:"button",class:"pill-btn mt-2 inline-flex items-center gap-2 rounded-full bg-orange-500 px-4 py-2.5 text-[var(--label-size)] font-semibold text-white shadow-md hover:bg-orange-600 transition-colors",onClick:e[3]||(e[3]=l=>k.value=!0)}," Add your first vendor ")])):T.value.length===0?(r(),s("div",Ne,[t("p",null,i(u.value?"No matching vendors.":"No vendors yet."),1),u.value?(r(),s("button",{key:0,type:"button",class:"pill-btn mt-2 text-[var(--color-text-muted)] hover:text-[var(--color-text)]",onClick:e[4]||(e[4]=l=>u.value="")}," Clear search ")):y("",!0)])):(r(),s("div",Re,[t("div",Ce,[t("table",Le,[e[23]||(e[23]=t("thead",null,[t("tr",null,[t("th",null,"Vendor ID"),t("th",null,"Vendor Name"),t("th",null,"Location"),t("th",null,"Email"),t("th",null,"Tin Number"),t("th",null,"GRA Expiry"),t("th",null,"WHT Expiry"),t("th",{class:"tax-table__actions-th"})])],-1)),t("tbody",null,[(r(!0),s(O,null,P(Y.value,(l,h)=>(r(),s("tr",{key:l.recordId||h},[t("td",null,i(V(l,"Vendor_ID")),1),t("td",null,i(V(l,"Vendor_Name")),1),t("td",null,i(V(l,"Vendor_Location")),1),t("td",null,i(V(l,"Vendor_Email")),1),t("td",null,i(V(l,"Tin_Number")),1),t("td",null,i(z(V(l,"GRA_Expiry_Date"))),1),t("td",null,i(z(V(l,"WHT_Expiry_Date"))),1),t("td",Me,[t("button",{type:"button",class:"tax-table__edit-btn","aria-label":"Edit",onClick:R=>J(l)},[...e[22]||(e[22]=[t("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),G(" Edit ",-1)])],8,He)])]))),128))])])]),N.value>1?(r(),s("div",Se,[t("button",{type:"button",class:"pagination__btn",disabled:_.value<=1,"aria-label":"Previous page",onClick:e[5]||(e[5]=l=>_.value=Math.max(1,_.value-1))},[...e[24]||(e[24]=[t("svg",{class:"pagination__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,Ie),t("span",We," Page "+i(_.value)+" of "+i(N.value),1),t("button",{type:"button",class:"pagination__btn",disabled:_.value>=N.value,"aria-label":"Next page",onClick:e[6]||(e[6]=l=>_.value=Math.min(N.value,_.value+1))},[...e[25]||(e[25]=[t("svg",{class:"pagination__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Ae)])):y("",!0)]))]),(r(),se(de,{to:"body"},[k.value?(r(),s("div",Be,[t("div",{class:"tax-modal vendor-modal",role:"dialog","aria-labelledby":c.value?"edit-vendor-title":"add-vendor-title","aria-modal":"true"},[t("header",$e,[t("h2",{id:c.value?"edit-vendor-title":"add-vendor-title",class:"tax-modal__title"},i(c.value?"Edit Vendor":"Add Vendor"),9,Ue),t("button",{type:"button",class:"tax-modal__close","aria-label":"Close",onClick:A},[...e[26]||(e[26]=[t("svg",{class:"tax-modal__close-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),b.value?(r(),s("div",je,[e[27]||(e[27]=t("svg",{class:"tax-modal__error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),t("span",Fe,i(b.value),1)])):y("",!0),t("form",{class:"tax-modal__form",onSubmit:ie(ee,["prevent"])},[t("section",ze,[e[33]||(e[33]=t("h3",{class:"tax-modal__section-title"},"Basic details",-1)),t("label",Oe,[e[28]||(e[28]=t("span",null,"Vendor ID",-1)),p(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.Vendor_ID=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"Vendor ID"},null,512),[[m,o.value.Vendor_ID]])]),t("label",Pe,[e[29]||(e[29]=t("span",null,"Vendor Name",-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.Vendor_Name=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"Vendor name",required:""},null,512),[[m,o.value.Vendor_Name]])]),t("label",qe,[e[30]||(e[30]=t("span",null,"Vendor Location",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.Vendor_Location=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"Location"},null,512),[[m,o.value.Vendor_Location]])]),t("label",Ke,[e[31]||(e[31]=t("span",null,"Vendor Email",-1)),p(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.Vendor_Email=l),type:"email",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"email@example.com"},null,512),[[m,o.value.Vendor_Email]])]),t("label",Qe,[e[32]||(e[32]=t("span",null,"Tin Number",-1)),p(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.Tin_Number=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"TIN"},null,512),[[m,o.value.Tin_Number]])])]),t("section",Ye,[e[38]||(e[38]=t("h3",{class:"tax-modal__section-title"},"Dates",-1)),t("div",Ze,[t("label",Je,[e[34]||(e[34]=t("span",null,"GRA Expiry Date",-1)),p(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.GRA_Expiry_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.GRA_Expiry_Date]])]),t("label",Xe,[e[35]||(e[35]=t("span",null,"Received Date",-1)),p(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.Received_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.Received_Date]])])]),t("div",et,[t("label",tt,[e[36]||(e[36]=t("span",null,"WHT Expiry Date",-1)),p(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>o.value.WHT_Expiry_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.WHT_Expiry_Date]])]),t("label",lt,[e[37]||(e[37]=t("span",null,"Received WHT Date",-1)),p(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.Received_WHT_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.Received_WHT_Date]])])])]),t("div",at,[t("button",{type:"button",class:"tax-modal__btn-cancel",onClick:A}," Cancel "),t("button",{type:"submit",class:"tax-modal__btn-submit",disabled:E.value},i(E.value?"Saving…":c.value?"Save":"Add Vendor"),9,ot)])],32)],8,Ge)])):y("",!0)]))])}}}),dt=ce(nt,[["__scopeId","data-v-e9c2ea97"]]);export{dt as default};
