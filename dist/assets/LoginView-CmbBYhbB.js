import{d as ae,u as se,o as le,a as te,c as r,b as M,n as oe,e as l,f as m,w as ie,g as L,h as P,T as q,r as t,i as E,j as d,k as ne,l as re,m as de,p as S,v as U,q as A,t as B,s as ue,x as ve,y as T,z as _e,A as ce,_ as pe}from"./index-B7jQKMlp.js";const fe=["points"],ge={class:"login__card"},me={class:"login__card-content"},he={class:"login__brand"},ye={class:"login__steps","aria-hidden":"true"},be={class:"login__slide-track"},ke={key:"email",class:"login__step"},we={key:0,class:"login__field"},xe={class:"login__field"},Me=["disabled"],Ee={key:"password",class:"login__step"},Se={class:"login__email-display"},Ue={class:"login__email-value"},Be={class:"login__field"},Ve={key:0,class:"login__error"},Fe=["disabled"],Ne={key:0,class:"login__btn-content"},Ce={key:1,class:"login__btn-content"},G=24,Ie=ae({__name:"LoginView",setup(Re){const $=ne(),j=re(),u=se(),{login:z,hasBaseUrl:D,error:Y}=ve(),v=t(""),_=t(""),p=t(""),o=t(!1),c=t(null),i=t(!1),n=t("email"),V=t(null),h=E(()=>{var a;return!!((a=ce())!=null&&a.trim())}),f=t([]),y=t(0),b=t(0);let k=0,w=!1;const X=E(()=>({opacity:w?1:0})),W=E(()=>{const a=f.value;return a.length<2?"":a.map(e=>`${e.x},${e.y}`).join(" ")});function H(a){y.value=a.clientX,b.value=a.clientY}function O(a){w=!0;const e=a.clientX,s=a.clientY;y.value=e,b.value=s,f.value=Array.from({length:G},()=>({x:e,y:s}))}function J(){w=!1}function F(a,e,s){return a+(e-a)*s}function N(){let a=y.value,e=b.value;const s=[],g=.18;for(let x=0;x<G;x++){const C=f.value[x]??{x:a,y:e},I=F(C.x,a,g),R=F(C.y,e,g);s.push({x:I,y:R}),a=I,e=R}f.value=s,k=requestAnimationFrame(N)}le(()=>{k=requestAnimationFrame(N)}),te(()=>{cancelAnimationFrame(k)});async function K(){if(c.value=null,i.value=!1,!h.value&&!v.value.trim()){u.error("Enter FileMaker base URL");return}if(!_.value.trim()){u.error("Enter your email"),i.value=!0;return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_.value.trim())){u.error("Enter a valid email address"),i.value=!0;return}o.value=!0;try{!h.value&&v.value.trim()&&T(v.value.trim());const{exists:e,error:s}=await _e(_.value.trim());if(s){u.error(s),i.value=!0;return}if(!e){u.error("This email is not registered. Contact your administrator."),i.value=!0;return}n.value="password"}finally{o.value=!1}}function Q(){var a;n.value==="password"&&((a=V.value)==null||a.focus())}function Z(){c.value=null,i.value=!1,n.value="email"}async function ee(){var a;if(c.value=null,!p.value){u.error("Enter your password");return}o.value=!0;try{if(!h.value&&v.value.trim()&&T(v.value.trim()),await z({username:_.value.trim(),password:p.value.trim()})){o.value=!1;const s=(a=j.query)==null?void 0:a.redirect,g=typeof s=="string"&&s.startsWith("/")&&!s.startsWith("//")&&!s.includes(":")?s:"/home";$.replace(g)}else{c.value=null,p.value="";const s=Y.value||"Invalid credentials. Please try again.";u.error(s)}}finally{o.value=!1}}return(a,e)=>(d(),r("div",{class:"login",onMousemove:H,onMouseenter:O,onMouseleave:J},[e[13]||(e[13]=M('<div class="login__bg" aria-hidden="true" data-v-2f5e548e></div><div class="login__bg-glow" aria-hidden="true" data-v-2f5e548e></div><div class="login__bg-shapes" aria-hidden="true" data-v-2f5e548e><div class="login__shape login__shape--1" data-v-2f5e548e></div><div class="login__shape login__shape--2" data-v-2f5e548e></div><div class="login__shape login__shape--3" data-v-2f5e548e></div><div class="login__shape login__shape--4" data-v-2f5e548e></div><div class="login__shape login__shape--5" data-v-2f5e548e></div></div><div class="login__bg-drops" aria-hidden="true" data-v-2f5e548e><div class="login__drop login__drop--1" data-v-2f5e548e></div><div class="login__drop login__drop--2" data-v-2f5e548e></div><div class="login__drop login__drop--3" data-v-2f5e548e></div><div class="login__drop login__drop--4" data-v-2f5e548e></div><div class="login__drop login__drop--5" data-v-2f5e548e></div><div class="login__drop login__drop--6" data-v-2f5e548e></div><div class="login__drop login__drop--7" data-v-2f5e548e></div><div class="login__drop login__drop--8" data-v-2f5e548e></div></div><div class="login__bg-grid" aria-hidden="true" data-v-2f5e548e></div><div class="login__bg-dots" aria-hidden="true" data-v-2f5e548e></div><div class="login__bg-noise" aria-hidden="true" data-v-2f5e548e></div>',7)),(d(),r("svg",{class:"login__cursor-flame","aria-hidden":"true",style:oe(X.value)},[e[5]||(e[5]=M('<defs data-v-2f5e548e><linearGradient id="flame-gradient" x1="0%" y1="0%" x2="100%" y2="0%" data-v-2f5e548e><stop offset="0%" stop-color="rgba(147, 197, 253, 0.95)" data-v-2f5e548e></stop><stop offset="35%" stop-color="rgba(99, 102, 241, 0.6)" data-v-2f5e548e></stop><stop offset="70%" stop-color="rgba(168, 85, 247, 0.25)" data-v-2f5e548e></stop><stop offset="100%" stop-color="transparent" data-v-2f5e548e></stop></linearGradient><filter id="flame-glow" x="-50%" y="-50%" width="200%" height="200%" data-v-2f5e548e><feGaussianBlur in="SourceGraphic" stdDeviation="1" result="blur" data-v-2f5e548e></feGaussianBlur><feMerge data-v-2f5e548e><feMergeNode in="blur" data-v-2f5e548e></feMergeNode><feMergeNode in="SourceGraphic" data-v-2f5e548e></feMergeNode></feMerge></filter></defs>',1)),l("polyline",{fill:"none",stroke:"url(#flame-gradient)","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",filter:"url(#flame-glow)",points:W.value},null,8,fe)],4)),l("div",ge,[l("div",me,[l("div",he,[e[6]||(e[6]=M('<div class="login__logo" data-v-2f5e548e><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-2f5e548e><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-2f5e548e></path></svg></div><h1 class="login__title" data-v-2f5e548e>Finance Payables</h1><p class="login__subtitle" data-v-2f5e548e>Sign in to continue</p>',3)),l("div",ye,[l("span",{class:m(["login__step-dot",{"login__step-dot--active":n.value==="email"}])},null,2),l("span",{class:m(["login__step-line",{"login__step-line--filled":n.value==="password"}])},null,2),l("span",{class:m(["login__step-dot",{"login__step-dot--active":n.value==="password"}])},null,2)])]),l("div",be,[l("form",{class:"login__form",onSubmit:e[4]||(e[4]=ie(s=>n.value==="email"?K():ee(),["prevent"]))},[L(q,{name:"login-step",mode:"out-in",onAfterEnter:Q},{default:P(()=>[n.value==="email"?(d(),r("div",ke,[de(D)?A("",!0):(d(),r("label",we,[e[7]||(e[7]=l("span",{class:"login__label"},"FileMaker base URL",-1)),S(l("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"url",class:"login__input",placeholder:"https://host/fmi/data/v1/databases/YourDB",required:"",autocomplete:"url"},null,512),[[U,v.value]])])),l("label",xe,[e[8]||(e[8]=l("span",{class:"login__label"},"Email",-1)),S(l("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),type:"email",class:m(["login__input",{"login__input--error":i.value}]),placeholder:"name@example.com",required:"",autocomplete:"email",onInput:e[2]||(e[2]=s=>i.value=!1)},null,34),[[U,_.value]])]),l("button",{type:"submit",class:"login__btn",disabled:o.value},B(o.value?"Checking…":"Proceed"),9,Me)])):(d(),r("div",Ee,[l("div",Se,[e[9]||(e[9]=l("span",{class:"login__label"},"Signing in as",-1)),l("span",Ue,B(_.value),1),l("button",{type:"button",class:"login__back",onClick:Z}," Change ")]),l("label",Be,[e[10]||(e[10]=l("span",{class:"login__label"},"Password",-1)),S(l("input",{ref_key:"passwordInputRef",ref:V,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s),type:"password",class:"login__input",placeholder:"Enter your password",required:"",autocomplete:"current-password"},null,512),[[U,p.value]])]),L(q,{name:"login-error"},{default:P(()=>[c.value?(d(),r("p",Ve,B(c.value),1)):A("",!0)]),_:1}),l("button",{type:"submit",class:"login__btn",disabled:o.value},[o.value?(d(),r("span",Ne,[...e[11]||(e[11]=[l("span",{class:"login__spinner"},null,-1),ue(" Signing in… ",-1)])])):(d(),r("span",Ce,"Sign in"))],8,Fe)]))]),_:1})],32)]),e[12]||(e[12]=l("p",{class:"login__hint"},"Use your FileMaker account credentials",-1))])])],32))}}),Pe=pe(Ie,[["__scopeId","data-v-2f5e548e"]]);export{Pe as default};
