const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdfmake-B32-QUBv.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/vfs_fonts-D-4-wbPz.js"])))=>i.map(i=>d[i]);
import{Q as bt,P as wt,u as ht,Z as st,L as _t,x as gt,d as St,D as Dt,o as xt,H as ft,c as _,e as n,p as lt,v as dt,q as X,b as mt,f as P,m as pt,t as L,F as ut,B as vt,r as $,i as ct,j as v,I as Ct,h as kt,w as Tt,C as Pt,M as At,_ as Nt}from"./index-B7jQKMlp.js";import{u as yt}from"./documentSettingsStore-Bd0QdTFI.js";function Z(l){if(l==null||l==="")return"—";const M=typeof l=="number"?l:parseFloat(String(l).replace(/,/g,""));return Number.isNaN(M)?"—":M.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function Ft(l,M=""){const C=Math.floor(l),H=Math.round((l-C)*100),W=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],k=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],E=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];function R(a){return a===0?"Zero":a<10?W[a]:a<20?k[a-10]:a<100?(E[Math.floor(a/10)]+" "+W[a%10]).trim():a<1e3?(W[Math.floor(a/100)]+" Hundred "+R(a%100)).trim():a<1e6?(R(Math.floor(a/1e3))+" Thousand "+R(a%1e3)).trim():a<1e9?(R(Math.floor(a/1e6))+" Million "+R(a%1e6)).trim():String(a)}const U=C===0?"Zero":R(C),b=M?` ${M}`:"";return H===0?`${U}${b} only`:`${U}${b} and ${H}/100`}function Rt(){const l=bt(),M=wt(),C=yt(),{isConnected:H,findRecordsByQueryWithIds:W}=gt(),k=ht();async function E(){var c;const b=l.mainStatus,a=C.invoiceDownloadWhen;if(!(l.mainPosted&&(a==="approved_only"?b==="Approved":a==="once_posted"?b==="Posted"||b==="Approved":!1)))return!1;try{const[f,h]=await Promise.all([st(()=>import("./pdfmake-B32-QUBv.js").then(y=>y.p),__vite__mapDeps([0,1])),st(()=>import("./vfs_fonts-D-4-wbPz.js").then(y=>y.v),__vite__mapDeps([2,1]))]),d=f.default??f,m=h.default??h;d.addVirtualFileSystem&&m&&d.addVirtualFileSystem(m);const g=((c=l.currentTransRef)==null?void 0:c.trim())??"",A=await U(),j=g?`APPROVED · ${g}`:"APPROVED",Y={pageSize:"A4",pageOrientation:"landscape",pageMargins:[40,50,40,70],defaultStyle:{fontSize:10,color:"#000"},watermark:{text:j,color:"#b0b0b0",opacity:.12,bold:!0,angle:-45},content:A,footer:(y,N)=>({margin:[40,10,40,0],stack:[{text:`PAGE ${y} of ${N}`,fontSize:9,alignment:"center"},{text:"Finance Payables  ·  "+new Date().toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}),fontSize:8,alignment:"center",margin:[0,2,0,0]}]})},O=g?`Approved-Payable-${g.replace(/[/\\?%*:|"<>]/g,"-")}.pdf`:"Approved-Payable.pdf";return await d.createPdf(Y).download(O),k.success("PDF downloaded."),!0}catch(f){const h=f instanceof Error?f.message:"PDF download failed.";return k.error(h),!1}}async function R(b){const a=C.invoiceDownloadWhen;if(a==="none")return 0;const B=b.map(c=>(c??"").trim()).filter(Boolean);if(B.length===0)return 0;try{const[c,f]=await Promise.all([st(()=>import("./pdfmake-B32-QUBv.js").then(r=>r.p),__vite__mapDeps([0,1])),st(()=>import("./vfs_fonts-D-4-wbPz.js").then(r=>r.v),__vite__mapDeps([2,1]))]),h=c.default??c,d=f.default??f;h.addVirtualFileSystem&&d&&h.addVirtualFileSystem(d);const m=[];for(const r of B){if(await l.fetchDetailsByTransRef(r),l.error||!l.mainPosted)continue;const y=l.mainStatus;if(!(a==="approved_only"?y==="Approved":a==="once_posted"?y==="Posted"||y==="Approved":!1))continue;const z=await U();z.length&&m.push(z)}const g=m.flatMap((r,y)=>{if(y<m.length-1&&r.length>0){const N=r[r.length-1],z=typeof N=="object"&&N!==null&&!Array.isArray(N)?{...N,pageBreak:"after"}:N;return[...r.slice(0,-1),z]}return r});if(g.length===0)return k.error("No downloadable invoices in the selection."),0;const A=new Date().toISOString().slice(0,10),j={pageSize:"A4",pageOrientation:"landscape",pageMargins:[40,50,40,70],defaultStyle:{fontSize:10,color:"#000"},watermark:{text:"APPROVED",color:"#b0b0b0",opacity:.12,bold:!0,angle:-45},content:g,footer:(r,y)=>({margin:[40,10,40,0],stack:[{text:`PAGE ${r} of ${y}`,fontSize:9,alignment:"center"},{text:"Finance Payables  ·  "+new Date().toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}),fontSize:8,alignment:"center",margin:[0,2,0,0]}]})},Y=`Combined-Payables-${A}.pdf`;return await h.createPdf(j).download(Y),k.success(`Downloaded combined PDF (${m.length} invoices).`),m.length}catch(c){const f=c instanceof Error?c.message:"Combined PDF download failed.";return k.error(f),0}}async function U(){var et,nt,J,ot,at,it;const b=((et=l.currentTransRef)==null?void 0:et.trim())??"",a=M.vendor,B=typeof l.entryTotal=="number"?l.entryTotal:0,c=Z(B),f=(a.currency?`${a.currency} `:"")+c,h=new Date().toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),d=[b,a.vendor_id,a.vendor_name].filter(Boolean).join("  ·  ")||"—",m=Ft(B,a.currency||""),g=l.rows.filter(s=>(s.invoice_number??"").trim()!==""||(s.amount??"").trim()!==""||(s.total??"").trim()!==""),A=g.reduce((s,w)=>{const D=parseFloat(String(w.amount??"").replace(/,/g,""));return s+(Number.isNaN(D)?0:D)},0),j=g.reduce((s,w)=>{const D=parseFloat(String(w.tax??"").replace(/,/g,""));return s+(Number.isNaN(D)?0:D)},0),Y=(a.currency?`${a.currency} `:"")+Z(A),O=[...new Set(g.map(s=>(s.invoice_number??"").trim()).filter(Boolean))],r=new Map;H.value&&O.length>0&&(await Promise.all(O.map(w=>W(_t.PAYABLE_INVOICE,{invoiceNumber:w},100)))).forEach((w,D)=>{var G;const K=O[D];K&&((G=w.data)!=null&&G.length)&&r.set(K,w.data.map(Q=>Q.fieldData).filter(Boolean))});function y(s){const w=(s.invoice_number??"").trim();if(!w)return"—";const D=r.get(w);return D!=null&&D.length?D.map(G=>{const Q=Number(G.Rate??0),e=(G.TaxName??"").trim()||"Tax",t=Q!==0?`${Q}%`:"";return`${e}${t?` ${t}`:""}`}).join(", "):"—"}const z=[[{text:"Invoice No.",fillColor:"#ebebeb",bold:!0},{text:"Amount",fillColor:"#ebebeb",bold:!0,alignment:"right"},{text:"Tax",fillColor:"#ebebeb",bold:!0,alignment:"right"},{text:"Tax Amount",fillColor:"#ebebeb",bold:!0,alignment:"right"},{text:"Tax breakdown",fillColor:"#ebebeb",bold:!0,fontSize:9},{text:"Total",fillColor:"#ebebeb",bold:!0,alignment:"right"}],...g.map(s=>{const w=(s.reference??"").trim()||(s.tax??"");return[(s.invoice_number??"").trim()||"—",{text:Z(s.amount??""),alignment:"right"},{text:Z(s.tax??""),alignment:"right"},{text:Z(w),alignment:"right"},{text:y(s),fontSize:9},{text:Z(s.total??""),alignment:"right"}]})];return[{columns:[{text:"Invoice Payment - PDF",fontSize:15,bold:!0},{text:h.toUpperCase(),fontSize:10,alignment:"right",width:"*"}],margin:[0,0,0,10]},{canvas:[{type:"line",x1:0,y1:0,x2:762,y2:0}],margin:[0,4,0,10]},{text:d,alignment:"center",bold:!0,fontSize:12,margin:[0,0,0,6]},{table:{widths:[120,"*"],body:[[{text:"Vendor ID",bold:!0,fillColor:"#f5f5f5"},((nt=a.vendor_id)==null?void 0:nt.trim())||"—"],[{text:"Vendor name",bold:!0,fillColor:"#f5f5f5"},((J=a.vendor_name)==null?void 0:J.trim())||"—"],[{text:"Date",bold:!0,fillColor:"#f5f5f5"},((ot=a.payment_terms)==null?void 0:ot.trim())||h],[{text:"Email",bold:!0,fillColor:"#f5f5f5"},((at=a.contact_email)==null?void 0:at.trim())||"—"],[{text:"Currency",bold:!0,fillColor:"#f5f5f5"},((it=a.currency)==null?void 0:it.trim())||"—"]]},layout:{hLineWidth:()=>.2,vLineWidth:()=>.2},margin:[0,0,0,12]},{canvas:[{type:"line",x1:0,y1:0,x2:762,y2:0}],margin:[0,0,0,12]},{table:{headerRows:1,widths:[110,95,90,95,"*",100],body:z},layout:{hLineWidth:()=>.25,vLineWidth:()=>.25},margin:[0,0,0,14]},{columns:[{width:"*",stack:[{text:"Amount in words",bold:!0,fontSize:9,margin:[0,0,0,4]},{text:m,fontSize:10}],fillColor:"#f8f8f8",margin:[0,4,8,4]},{width:240,table:{widths:[130,"*"],body:[[{text:"Sub Total (excl. tax)",fontSize:9,fillColor:"#f5f5f5"},{text:Y,fontSize:9,alignment:"right",fillColor:"#f5f5f5"}],[{text:"Total Tax",fontSize:9,fillColor:"#f5f5f5"},{text:Z(j),fontSize:9,alignment:"right",fillColor:"#f5f5f5"}],[{text:"Advance Payment",fontSize:9,fillColor:"#f5f5f5"},{text:"—",fontSize:9,alignment:"right",fillColor:"#f5f5f5"}],[{text:"Amount to Pay",fontSize:9,bold:!0,fillColor:"#f5f5f5"},{text:f,fontSize:9,bold:!0,alignment:"right",fillColor:"#f5f5f5"}]]},layout:{hLineWidth:()=>.2,vLineWidth:()=>.2}}]}]}return{buildAndDownloadPdf:E,buildAndDownloadCombinedPdf:R}}const Bt={class:"content-area flex flex-col flex-1 min-h-0 w-full max-w-[1600px] mx-auto px-4 py-5 md:px-6 md:py-6 min-h-[400px]"},It={class:"invoices-header sticky top-0 z-10 -mx-4 -mt-5 px-4 pt-5 pb-4 md:-mx-6 md:-mt-6 md:px-6 md:pt-6 md:pb-4 mb-6 bg-[#0f172a] border-b border-[var(--color-border)]"},Lt={class:"invoices-toolbar"},$t={class:"invoice-search-wrap"},Mt={class:"invoice-search relative"},Et={class:"invoice-date-range"},jt={class:"invoice-date-range__inputs"},zt={for:"invoice-date-from",class:"invoice-date-range__field"},Vt={for:"invoice-date-to",class:"invoice-date-range__field"},qt={class:"status-filters"},Wt=["disabled","title"],Ot={key:0,class:"invoice-download-all__count"},Ht={key:0,class:"pdf-grid"},Ut={key:1,class:"rounded-2xl bg-red-500/10 border border-red-500/20 px-5 py-4 text-[var(--label-size)] text-red-300"},Yt={key:2,class:"glass rounded-2xl p-12 text-center"},Gt={class:"text-[var(--color-text-muted)]"},Qt={key:0,class:"invoices-empty-msg"},Zt={key:1,class:"pdf-grid"},Xt=["aria-label"],Jt={class:"pdf-thumb__page"},Kt={class:"pdf-thumb__top"},te={class:"pdf-thumb__top-right"},ee=["disabled","onClick"],ne={key:0,class:"pdf-thumb__download-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oe={key:1,class:"pdf-thumb__download-spinner","aria-hidden":"true"},ae={class:"pdf-thumb__main"},ie={class:"pdf-thumb__title"},re={class:"pdf-thumb__sub"},se={class:"pdf-thumb__total"},le={class:"pdf-thumb__meta"},de={key:0,class:"pdf-thumb__cheque"},ue={class:"pdf-thumb__cheque-value"},ce={key:0,class:"pdf-thumb__cheque-date"},fe={class:"pdf-thumb__footer"},me=St({__name:"InvoicesView",setup(l){const{findRecordsWithIds:M,isConnected:C}=gt(),H=Dt(),W=yt(),k=ht(),E=bt(),{buildAndDownloadPdf:R,buildAndDownloadCombinedPdf:U}=Rt(),b=$([]),a=$(!1),B=$(null),c=$(""),f=$(""),h=$(""),d=$(""),m=$(""),g=$(null),A=$(!1),j=ct(()=>{let e=b.value;const t=d.value;t&&(e=e.filter(x=>String(x.fieldData.Status??"").trim()===t));const i=m.value;i&&(e=e.filter(x=>{const p=s(x.fieldData);return i==="issued"?p==="Yes":p!=="Yes"}));const o=f.value.trim(),S=h.value.trim();if(o||S){const x=o?new Date(o+"T00:00:00").getTime():0,p=S?new Date(S+"T23:59:59.999").getTime():Number.MAX_SAFE_INTEGER;e=e.filter(V=>{const I=y(V.fieldData.Date);return I===null?!1:I>=x&&I<=p})}const u=c.value.trim().toLowerCase();return u&&(e=e.filter(x=>{const p=x.fieldData,V=String(p.TransRef??"").toLowerCase(),I=String(p.VendorName??"").toLowerCase(),q=String(p.Status??"").toLowerCase(),F=N(p.Date).toLowerCase(),T=z(p).toLowerCase(),tt=String(p.Currency??"").toLowerCase();return V.includes(u)||I.includes(u)||q.includes(u)||F.includes(u)||T.includes(u)||tt.includes(u)})),[...e].sort((x,p)=>{const V=x.fieldData.CreationTimestamp??x.fieldData.Date??"",I=p.fieldData.CreationTimestamp??p.fieldData.Date??"",q=new Date(V).getTime(),F=new Date(I).getTime(),T=Number.isNaN(q)?0:q;return(Number.isNaN(F)?0:F)-T})}),Y=ct(()=>d.value!==""||m.value!==""||c.value.trim()!==""||f.value.trim()!==""||h.value.trim()!=="");function O(e){const t=e.TransRef??(e==null?void 0:e["Trans Ref"]);return t!=null&&String(t).trim()!==""?String(t).trim():""}const r=ct(()=>j.value.filter(e=>{const t=e.fieldData,i=String((t==null?void 0:t.Status)??(t==null?void 0:t.Status)??"").trim();return J(i)}).map(e=>O(e.fieldData)).filter(Boolean));function y(e){const t=e!=null?String(e).trim():"";if(!t)return null;let i;if(/^\d{4}-\d{2}-\d{2}/.test(t))i=new Date(t);else if(/^\d{1,2}\/\d{1,2}\/\d{4}/.test(t)){const[o,S,u]=t.split(/[/\s]/);i=new Date(parseInt(u,10),parseInt(o,10)-1,parseInt(S,10))}else i=new Date(t);return Number.isNaN(i.getTime())?null:i.getTime()}function N(e){if(!e)return"—";try{const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})}catch{return e}}function z(e){const t=(e.Currency??"").toString().trim(),i=e.Total,o=Pt(i);return o?t?`${t} ${o}`:o:"—"}function et(e){const t=(e??"").toLowerCase();return t==="draft"?"pdf-thumb__status--draft":t==="posted"?"pdf-thumb__status--posted":t==="rejected"?"pdf-thumb__status--rejected":t==="approved"?"pdf-thumb__status--approved":"pdf-thumb__status--neutral"}function nt(e){const t=(e??"").toLowerCase();return t==="draft"?"bg-amber-500/15 text-amber-400":t==="posted"?"bg-blue-500/15 text-blue-400":t==="rejected"?"bg-red-500/15 text-red-400":t==="approved"?"bg-emerald-500/15 text-emerald-400":"bg-white/10 text-[var(--color-text-muted)]"}function J(e){const t=W.invoiceDownloadWhen;if(t==="none")return!1;const i=(e??"").trim();return t==="approved_only"?i==="Approved":t==="once_posted"?i==="Posted"||i==="Approved":!1}async function ot(){const e=r.value;if(!(e.length===0||!C.value)){A.value=!0;try{await U(e)}finally{A.value=!1}}}async function at(e){const t=(e??"").trim();if(!(!t||!C.value)){g.value=t;try{if(await E.fetchDetailsByTransRef(t),E.error){k.error(E.error);return}if(!E.mainPosted){k.error("Entry not found or not available for PDF download.");return}const i=E.mainStatus,o=W.invoiceDownloadWhen;if(!(o==="approved_only"?i==="Approved":o==="once_posted"?i==="Posted"||i==="Approved":!1)){k.error("This entry is not available for PDF download with current settings.");return}await R()}catch(i){const o=i instanceof Error?i.message:"Download failed.";k.error(o)}finally{g.value=null}}}function it(e){const t=(e??"").toLowerCase();return t==="draft"?"pdf-thumb__dot--draft":t==="posted"?"pdf-thumb__dot--posted":t==="rejected"?"pdf-thumb__dot--rejected":t==="approved"?"pdf-thumb__dot--approved":"pdf-thumb__dot--neutral"}function s(e){const t=e.ChequeIssued??(e==null?void 0:e["Cheque Issued"]);return t!=null&&String(t).trim()!==""?String(t).trim():""}function w(e){const t=e.ChequeIssuedDate??(e==null?void 0:e["Cheque Issued Date"]),i=t!=null&&String(t).trim()?String(t).trim():"";if(!i)return"";try{const o=new Date(i);return Number.isNaN(o.getTime())?i:o.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})}catch{return i}}function D(e){const t=e.BankName??(e==null?void 0:e["Bank Name"]),i=e.ChequeNo??(e==null?void 0:e["Cheque No"]),o=t!=null&&String(t).trim()?String(t).trim():"",S=i!=null&&String(i).trim()?String(i).trim():"",u=[];return o&&u.push(o),S&&u.push(`#${S}`),u.length>0?u.join(" · "):"—"}function K(e){const t=e==null?void 0:e.fieldData;if(!t)return"Draft";const i=t.Status??t.status;if(i!=null&&String(i).trim())return String(i).trim();const o=t.Approved??t.approved,S=t.Rejected??t.rejected,u=t.Posted??t.posted;return o!=null&&String(o).trim()?"Approved":S!=null&&String(S).trim()?"Rejected":u!=null&&String(u).trim()?"Posted":"Draft"}function G(){const e=b.value;let t=0,i=0,o=0,S=0;const u={},x={},p={},V={};for(const I of e){const q=K(I),F=I.fieldData,T=String((F==null?void 0:F.Currency)??"").trim()||"GHS",tt=Number(F==null?void 0:F.Total),rt=Number.isFinite(tt)?tt:0;q==="Draft"?(t++,u[T]=(u[T]??0)+rt):q==="Posted"?(i++,x[T]=(x[T]??0)+rt):q==="Rejected"?(o++,p[T]=(p[T]??0)+rt):q==="Approved"&&(S++,V[T]=(V[T]??0)+rt)}H.setCounts(t,i,o,S),H.setTotalsByCurrency(u,x,p,V)}async function Q(){if(!C.value){b.value=[];return}a.value=!0,B.value=null;try{const e=await M(_t.PAYABLES_MAIN,{limit:500});e.error?(k.error(e.error),b.value=[]):b.value=e.data}finally{a.value=!1}}return xt(Q),ft(C,e=>{e&&Q()}),ft(b,G,{immediate:!0}),(e,t)=>{const i=At("router-link");return v(),_("div",Bt,[n("header",It,[t[25]||(t[25]=n("h1",{class:"text-[1.75rem] font-bold tracking-tight text-[var(--color-text)] md:text-[2rem]",style:{"letter-spacing":"-0.025em","line-height":"1.2"}}," Invoices ",-1)),t[26]||(t[26]=n("p",{class:"mt-1.5 text-[13px] text-[var(--color-text-muted)]"}," All payable entries as PDF-style thumbnails. Click any thumbnail to open the entry. ",-1)),n("div",Lt,[n("div",$t,[t[14]||(t[14]=n("label",{for:"invoice-search",class:"sr-only"},"Search invoices",-1)),n("div",Mt,[t[13]||(t[13]=n("svg",{class:"invoice-search__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),lt(n("input",{id:"invoice-search","onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),type:"search",autocomplete:"off",placeholder:"Search by ref, vendor…",class:"invoice-search__input glass-input"},null,512),[[dt,c.value]]),c.value?(v(),_("button",{key:0,type:"button",class:"invoice-search__clear","aria-label":"Clear search",onClick:t[1]||(t[1]=o=>c.value="")},[...t[12]||(t[12]=[n("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):X("",!0)])]),n("div",Et,[t[19]||(t[19]=mt('<div class="invoice-date-range__icon" aria-hidden="true" data-v-320d741f><svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-320d741f><rect x="3" y="4" width="18" height="18" rx="2" ry="2" data-v-320d741f></rect><line x1="16" y1="2" x2="16" y2="6" data-v-320d741f></line><line x1="8" y1="2" x2="8" y2="6" data-v-320d741f></line><line x1="3" y1="10" x2="21" y2="10" data-v-320d741f></line></svg></div>',1)),n("div",jt,[n("label",zt,[t[15]||(t[15]=n("span",{class:"invoice-date-range__label"},"From",-1)),lt(n("input",{id:"invoice-date-from","onUpdate:modelValue":t[2]||(t[2]=o=>f.value=o),type:"date",class:"invoice-date-range__input","aria-label":"Filter by date from"},null,512),[[dt,f.value]])]),t[17]||(t[17]=n("span",{class:"invoice-date-range__sep","aria-hidden":"true"},"→",-1)),n("label",Vt,[t[16]||(t[16]=n("span",{class:"invoice-date-range__label"},"To",-1)),lt(n("input",{id:"invoice-date-to","onUpdate:modelValue":t[3]||(t[3]=o=>h.value=o),type:"date",class:"invoice-date-range__input","aria-label":"Filter by date to"},null,512),[[dt,h.value]])])]),f.value||h.value?(v(),_("button",{key:0,type:"button",class:"invoice-date-range__clear","aria-label":"Clear date range",onClick:t[4]||(t[4]=o=>{f.value="",h.value=""})},[...t[18]||(t[18]=[n("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("path",{d:"M6 18L18 6M6 6l12 12"})],-1)])])):X("",!0)]),n("div",qt,[t[22]||(t[22]=n("span",{class:"status-filters__label"},"Status",-1)),n("button",{type:"button",class:P(["status-filter-pill",{"status-filter-pill--active":d.value===""}]),onClick:t[5]||(t[5]=o=>d.value="")}," All ",2),n("button",{type:"button",class:P(["status-filter-pill status-filter-pill--draft",{"status-filter-pill--active":d.value==="Draft"}]),onClick:t[6]||(t[6]=o=>d.value="Draft")}," Draft ",2),n("button",{type:"button",class:P(["status-filter-pill status-filter-pill--posted",{"status-filter-pill--active":d.value==="Posted"}]),onClick:t[7]||(t[7]=o=>d.value="Posted")}," Posted ",2),n("button",{type:"button",class:P(["status-filter-pill status-filter-pill--rejected",{"status-filter-pill--active":d.value==="Rejected"}]),onClick:t[8]||(t[8]=o=>d.value="Rejected")}," Rejected ",2),n("button",{type:"button",class:P(["status-filter-pill status-filter-pill--approved",{"status-filter-pill--active":d.value==="Approved"}]),onClick:t[9]||(t[9]=o=>d.value="Approved")}," Approved ",2),t[23]||(t[23]=n("span",{class:"status-filters__divider","aria-hidden":"true"},null,-1)),n("button",{type:"button",class:P(["status-filter-pill status-filter-pill--cheque",{"status-filter-pill--active":m.value==="issued"}]),onClick:t[10]||(t[10]=o=>m.value=m.value==="issued"?"":"issued")}," Cheque issued ",2),n("button",{type:"button",class:P(["status-filter-pill status-filter-pill--cheque-not",{"status-filter-pill--active":m.value==="not_issued"}]),onClick:t[11]||(t[11]=o=>m.value=m.value==="not_issued"?"":"not_issued")}," Not issued ",2),t[24]||(t[24]=n("span",{class:"status-filters__divider","aria-hidden":"true"},null,-1)),n("button",{type:"button",class:P(["invoice-download-all pill-btn",{"invoice-download-all--loading":A.value}]),disabled:r.value.length===0||!pt(C)||A.value,title:r.value.length>0?`Download ${r.value.length} invoice${r.value.length===1?"":"s"} as combined PDF`:"No downloadable invoices in current filters","aria-label":"Download all shown invoices as combined PDF",onClick:ot},[(v(),_("svg",{class:P(["invoice-download-all__icon",{"invoice-download-all__icon--spin":A.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[...t[20]||(t[20]=[n("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},null,-1),n("polyline",{points:"7 10 12 15 17 10"},null,-1),n("line",{x1:"12",y1:"15",x2:"12",y2:"3"},null,-1)])],2)),t[21]||(t[21]=n("span",null,"PDF",-1)),r.value.length>0?(v(),_("span",Ot," ("+L(r.value.length)+") ",1)):X("",!0)],10,Wt)])])]),a.value?(v(),_("div",Ht,[(v(),_(ut,null,vt(12,o=>n("div",{key:o,class:"pdf-tile pdf-tile--skeleton"},[...t[27]||(t[27]=[mt('<div class="pdf-thumb" data-v-320d741f><div class="pdf-thumb__page animate-pulse" data-v-320d741f><div class="pdf-thumb__top" data-v-320d741f><span class="pdf-thumb__tag" data-v-320d741f>PDF</span><span class="pdf-thumb__dot pdf-thumb__dot--neutral" data-v-320d741f></span></div><div class="pdf-thumb__title-line" data-v-320d741f></div><div class="pdf-thumb__sub-line" data-v-320d741f></div><div class="pdf-thumb__line pdf-thumb__line--w1" data-v-320d741f></div><div class="pdf-thumb__line pdf-thumb__line--w2" data-v-320d741f></div><div class="pdf-thumb__line pdf-thumb__line--w3" data-v-320d741f></div><div class="pdf-thumb__line pdf-thumb__line--w4" data-v-320d741f></div></div></div>',1)])])),64))])):B.value?(v(),_("div",Ut,L(B.value),1)):b.value.length===0?(v(),_("div",Yt,[n("p",Gt,L(pt(C)?"No invoices yet.":"Connect to FileMaker to load invoices."),1)])):(v(),_(ut,{key:3},[j.value.length===0?(v(),_("p",Qt," No invoices match your "+L(Y.value?"filters":"search")+". ",1)):(v(),_("div",Zt,[(v(!0),_(ut,null,vt(j.value,o=>(v(),Ct(i,{key:o.recordId,to:{name:"entry",query:{transRef:o.fieldData.TransRef??"",from:"invoices"}},class:"pdf-tile"},{default:kt(()=>[n("div",{class:"pdf-thumb","aria-label":`Open invoice ${String(o.fieldData.TransRef??"").trim()}`},[n("div",Jt,[n("div",Kt,[t[29]||(t[29]=n("span",{class:"pdf-thumb__tag"},"PDF",-1)),n("div",te,[J(o.fieldData.Status)?(v(),_("button",{key:0,type:"button",class:"pdf-thumb__download",title:"Download PDF","aria-label":"Download PDF",disabled:g.value!==null,onClick:Tt(S=>at(o.fieldData.TransRef),["stop"])},[g.value!==(o.fieldData.TransRef??"")?(v(),_("svg",ne,[...t[28]||(t[28]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])):(v(),_("span",oe))],8,ee)):X("",!0),n("span",{class:P(["pdf-thumb__dot",it(o.fieldData.Status)])},null,2)])]),n("div",ae,[n("div",ie,L(o.fieldData.TransRef||"—"),1),n("div",re,L(o.fieldData.VendorName||"—"),1),n("div",se,L(z(o.fieldData)),1)]),n("div",le,[n("span",{class:P(["pdf-thumb__status",et(o.fieldData.Status)])},L(o.fieldData.Status||"—"),3),s(o.fieldData)==="Yes"?(v(),_("div",de,[t[30]||(t[30]=n("span",{class:"pdf-thumb__cheque-label"},"Cheque issued",-1)),n("span",ue,L(D(o.fieldData)),1),w(o.fieldData)?(v(),_("span",ce," Issued "+L(w(o.fieldData)),1)):X("",!0)])):X("",!0)]),n("div",fe,[n("div",{class:P(["pdf-thumb__icon",nt(o.fieldData.Status)]),"aria-hidden":"true"},[...t[31]||(t[31]=[n("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])],2),t[32]||(t[32]=n("div",{class:"pdf-thumb__lines"},[n("div",{class:"pdf-thumb__line pdf-thumb__line--w1"}),n("div",{class:"pdf-thumb__line pdf-thumb__line--w2"}),n("div",{class:"pdf-thumb__line pdf-thumb__line--w3"}),n("div",{class:"pdf-thumb__line pdf-thumb__line--w4"})],-1))])])],8,Xt)]),_:2},1032,["to"]))),128))]))],64))])}}}),be=Nt(me,[["__scopeId","data-v-320d741f"]]);export{be as default};
