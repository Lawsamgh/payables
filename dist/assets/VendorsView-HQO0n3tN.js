import{d as J,H as K,l as G,m as P,c as s,a as t,f as i,w as X,s as S,i as Z,v,x as m,b as y,t as d,F as U,r as $,q as ee,C as te,G as le,h as x,g as ae,L as M,A as oe,z as ne,o as r,R as re,_ as se}from"./index-DHrrxsNC.js";import{_ as u}from"./Skeleton.vue_vue_type_script_setup_true_lang-CR2pGYDY.js";const de={class:"content-area flex flex-col flex-1 min-h-0 w-full max-w-[1600px] mx-auto px-4 py-5 md:px-6 md:py-6"},ie={class:"flex flex-wrap items-center justify-between gap-4 mb-6"},ue={class:"flex flex-wrap items-center gap-3"},_e={key:0,class:"tax-search-bar"},ce={class:"tax-search-bar__row"},ve={key:0,class:"tax-search-bar__hint"},me={class:"tax-table-wrap"},pe={key:0,class:"tax-table-skeleton"},xe={class:"tax-table-skeleton__search"},be={class:"tax-table"},he={class:"tax-table__actions-th"},fe={class:"tax-table__actions-td"},Ve={key:1,class:"tax-table-error"},ye={key:2,class:"tax-table-empty"},ge={key:3,class:"tax-table-empty"},De={key:4,class:"tax-table-scroll"},we={class:"tax-table"},ke={class:"tax-table__actions-td"},Ee=["onClick"],Te={key:0,class:"tax-modal-backdrop"},Ne=["aria-labelledby"],Re={class:"tax-modal__header"},Le=["id"],Ce={key:0,class:"tax-modal__error",role:"alert"},He={class:"tax-modal__error-text"},We={class:"tax-modal__section"},Ie={class:"tax-modal__label"},Se={class:"tax-modal__label"},Me={class:"tax-modal__label"},Ae={class:"tax-modal__label"},Be={class:"tax-modal__label"},Ge={class:"tax-modal__section"},Ue={class:"tax-modal__row"},$e={class:"tax-modal__label"},Fe={class:"tax-modal__label"},ze={class:"tax-modal__row"},je={class:"tax-modal__label"},qe={class:"tax-modal__label"},Oe={class:"tax-modal__actions"},Qe=["disabled"],Ye=J({__name:"VendorsView",setup(Je){const{createRecord:F,updateRecord:z,findRecordsWithIds:j,isConnected:H}=ne(),A=K(),h=x([]),g=x(!0),D=x(null),V=x(!1),_=x(""),c=x(null),o=x({Vendor_ID:"",Vendor_Name:"",Vendor_Location:"",Vendor_Email:"",GRA_Expiry_Date:"",Received_Date:"",Tin_Number:"",WHT_Expiry_Date:"",Received_WHT_Date:""}),p=x(null),w=x(!1);function f(a,e){const n=a.fieldData,l=n[e]??n[e.replace(/_/g," ")];return l==null||l===""?"—":String(l).trim()}const T=ae(()=>{const a=_.value.toLowerCase();return a?h.value.filter(e=>{const n=e.fieldData,l=String(n.Vendor_ID??n["Vendor ID"]??"").toLowerCase(),b=String(n.Vendor_Name??n["Vendor Name"]??"").toLowerCase(),k=String(n.Vendor_Location??n["Vendor Location"]??"").toLowerCase(),L=String(n.Vendor_Email??n["Vendor Email"]??"").toLowerCase(),C=String(n.Tin_Number??n["Tin Number"]??"").toLowerCase();return l.includes(a)||b.includes(a)||k.includes(a)||L.includes(a)||C.includes(a)}):h.value});function B(a){return a!=null&&a.trim()?a.trim():"—"}function N(a){if(!(a!=null&&a.trim()))return"";const e=a.trim(),n=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/.exec(e);if(n){const l=n[1].padStart(2,"0"),b=n[2].padStart(2,"0");return`${n[3]}-${l}-${b}`}return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:""}function R(a){return re(a)}function W(){V.value=!1,c.value=null}function q(){c.value=null,o.value={Vendor_ID:"",Vendor_Name:"",Vendor_Location:"",Vendor_Email:"",GRA_Expiry_Date:"",Received_Date:"",Tin_Number:"",WHT_Expiry_Date:"",Received_WHT_Date:""},p.value=null}function O(a){const e=a.fieldData;o.value={Vendor_ID:String(e.Vendor_ID??e["Vendor ID"]??""),Vendor_Name:String(e.Vendor_Name??e["Vendor Name"]??""),Vendor_Location:String(e.Vendor_Location??e["Vendor Location"]??""),Vendor_Email:String(e.Vendor_Email??e["Vendor Email"]??""),GRA_Expiry_Date:N(e.GRA_Expiry_Date??e["GRA Expiry Date"]),Received_Date:N(e.Received_Date??e["Received Date"]),Tin_Number:String(e.Tin_Number??e["Tin Number"]??""),WHT_Expiry_Date:N(e.WHT_Expiry_Date??e["WHT Expiry Date"]),Received_WHT_Date:N(e.Received_WHT_Date??e["Received WHT Date"])},c.value=a.recordId,p.value=null,V.value=!0}G(V,a=>{a||(c.value=null)});function Q(){var a;return(a=o.value.Vendor_Name)!=null&&a.trim()?null:"Vendor Name is required."}async function Y(){var n,l,b,k,L;if(w.value)return;if(!H.value){p.value="Not connected to FileMaker.";return}const a=Q();if(a){p.value=a;return}w.value=!0,p.value=null;const e=c.value?String(c.value).trim():null;try{const C={Vendor_ID:((n=o.value.Vendor_ID)==null?void 0:n.trim())||void 0,Vendor_Name:(l=o.value.Vendor_Name)==null?void 0:l.trim(),Vendor_Location:((b=o.value.Vendor_Location)==null?void 0:b.trim())||void 0,Vendor_Email:((k=o.value.Vendor_Email)==null?void 0:k.trim())||void 0,GRA_Expiry_Date:R(o.value.GRA_Expiry_Date),Received_Date:R(o.value.Received_Date),Tin_Number:((L=o.value.Tin_Number)==null?void 0:L.trim())||void 0,WHT_Expiry_Date:R(o.value.WHT_Expiry_Date),Received_WHT_Date:R(o.value.Received_WHT_Date)};if(e){const{error:E}=await z(M.VENDOR_TBL,e,C);if(E){p.value=E;return}A.success("Vendor updated successfully.")}else{const{error:E}=await F(M.VENDOR_TBL,C);if(E){p.value=E;return}A.success("Vendor added successfully.")}W(),q(),await I()}finally{w.value=!1}}async function I(){if(!H.value){h.value=[],g.value=!1;return}g.value=!0,D.value=null;const{data:a,error:e}=await j(M.VENDOR_TBL,{limit:500});g.value=!1,e?(D.value=e,h.value=[]):h.value=a}return P(I),G(H,a=>{a&&I()}),(a,e)=>{const n=oe("router-link");return r(),s("div",de,[t("header",ie,[t("div",ue,[i(n,{to:"/",class:"pill-btn glass-input inline-flex items-center gap-1.5 px-3 py-2 text-[var(--label-size)] text-[var(--color-text-muted)] no-underline hover:text-[var(--color-text)]"},{default:X(()=>[...e[14]||(e[14]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),S(" Back ",-1)])]),_:1}),e[15]||(e[15]=t("h1",{class:"text-xl font-bold tracking-tight text-[var(--color-text)]"},"Vendors",-1))]),t("button",{type:"button",class:"pill-btn inline-flex items-center gap-2 rounded-full bg-orange-500 px-4 py-2.5 text-[var(--label-size)] font-semibold text-white shadow-md hover:bg-orange-600 transition-colors",onClick:e[0]||(e[0]=l=>V.value=!0)},[...e[16]||(e[16]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),S(" Add Vendor ",-1)])])]),e[35]||(e[35]=t("p",{class:"text-[var(--label-size)] text-[var(--color-text-muted)] mb-4"}," Manage vendors here. View, add, and edit vendor details. ",-1)),!g.value&&!D.value&&h.value.length>0?(r(),s("div",_e,[t("div",ce,[t("div",{class:Z(["search-bar__wrap tax-search-bar__search",{"search-bar__wrap--has-value":_.value}])},[e[18]||(e[18]=t("span",{class:"search-bar__icon","aria-hidden":"true"},[t("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",viewBox:"0 0 24 24"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>_.value=l),type:"search",class:"search-bar__input",placeholder:"Search vendors…",autocomplete:"off","aria-label":"Search vendors"},null,512),[[m,_.value,void 0,{trim:!0}]]),_.value?(r(),s("button",{key:0,type:"button",class:"search-bar__clear","aria-label":"Clear search",onClick:e[2]||(e[2]=l=>_.value="")},[...e[17]||(e[17]=[t("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2.5",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):y("",!0)],2)]),_.value?(r(),s("p",ve,d(T.value.length)+" result"+d(T.value.length===1?"":"s"),1)):y("",!0)])):y("",!0),t("div",me,[g.value?(r(),s("div",pe,[t("div",xe,[i(u,{width:"100%",height:"2.75rem",class:"rounded-xl"})]),t("table",be,[t("thead",null,[t("tr",null,[t("th",null,[i(u,{width:"5rem",height:"0.875rem",class:"rounded"})]),t("th",null,[i(u,{width:"6rem",height:"0.875rem",class:"rounded"})]),t("th",null,[i(u,{width:"4rem",height:"0.875rem",class:"rounded"})]),t("th",null,[i(u,{width:"4.5rem",height:"0.875rem",class:"rounded"})]),t("th",he,[i(u,{width:"2.5rem",height:"0.875rem",class:"rounded"})])])]),t("tbody",null,[(r(),s(U,null,$(6,l=>t("tr",{key:l,class:"tax-table-skeleton__row"},[t("td",null,[i(u,{width:"4rem",height:"0.875rem",class:"rounded"})]),t("td",null,[i(u,{width:"70%",height:"0.875rem",class:"rounded max-w-[8rem]"})]),t("td",null,[i(u,{width:"5rem",height:"0.875rem",class:"rounded"})]),t("td",null,[i(u,{width:"4rem",height:"0.875rem",class:"rounded"})]),t("td",fe,[i(u,{width:"3.5rem",height:"1.75rem",class:"rounded-lg"})])])),64))])])])):D.value?(r(),s("div",Ve,d(D.value),1)):h.value.length===0?(r(),s("div",ye,[e[19]||(e[19]=t("p",null,"No vendors yet.",-1)),t("button",{type:"button",class:"pill-btn mt-2 inline-flex items-center gap-2 rounded-full bg-orange-500 px-4 py-2.5 text-[var(--label-size)] font-semibold text-white shadow-md hover:bg-orange-600 transition-colors",onClick:e[3]||(e[3]=l=>V.value=!0)}," Add your first vendor ")])):T.value.length===0?(r(),s("div",ge,[t("p",null,d(_.value?"No matching vendors.":"No vendors yet."),1),_.value?(r(),s("button",{key:0,type:"button",class:"pill-btn mt-2 text-[var(--color-text-muted)] hover:text-[var(--color-text)]",onClick:e[4]||(e[4]=l=>_.value="")}," Clear search ")):y("",!0)])):(r(),s("div",De,[t("table",we,[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"Vendor ID"),t("th",null,"Vendor Name"),t("th",null,"Location"),t("th",null,"Email"),t("th",null,"Tin Number"),t("th",null,"GRA Expiry"),t("th",null,"WHT Expiry"),t("th",{class:"tax-table__actions-th"})])],-1)),t("tbody",null,[(r(!0),s(U,null,$(T.value,(l,b)=>(r(),s("tr",{key:l.recordId||b},[t("td",null,d(f(l,"Vendor_ID")),1),t("td",null,d(f(l,"Vendor_Name")),1),t("td",null,d(f(l,"Vendor_Location")),1),t("td",null,d(f(l,"Vendor_Email")),1),t("td",null,d(f(l,"Tin_Number")),1),t("td",null,d(B(f(l,"GRA_Expiry_Date"))),1),t("td",null,d(B(f(l,"WHT_Expiry_Date"))),1),t("td",ke,[t("button",{type:"button",class:"tax-table__edit-btn","aria-label":"Edit",onClick:k=>O(l)},[...e[20]||(e[20]=[t("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),S(" Edit ",-1)])],8,Ee)])]))),128))])])]))]),(r(),ee(le,{to:"body"},[V.value?(r(),s("div",Te,[t("div",{class:"tax-modal vendor-modal",role:"dialog","aria-labelledby":c.value?"edit-vendor-title":"add-vendor-title","aria-modal":"true"},[t("header",Re,[t("h2",{id:c.value?"edit-vendor-title":"add-vendor-title",class:"tax-modal__title"},d(c.value?"Edit Vendor":"Add Vendor"),9,Le),t("button",{type:"button",class:"tax-modal__close","aria-label":"Close",onClick:W},[...e[22]||(e[22]=[t("svg",{class:"tax-modal__close-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),p.value?(r(),s("div",Ce,[e[23]||(e[23]=t("svg",{class:"tax-modal__error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),t("span",He,d(p.value),1)])):y("",!0),t("form",{class:"tax-modal__form",onSubmit:te(Y,["prevent"])},[t("section",We,[e[29]||(e[29]=t("h3",{class:"tax-modal__section-title"},"Basic details",-1)),t("label",Ie,[e[24]||(e[24]=t("span",null,"Vendor ID",-1)),v(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.Vendor_ID=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"Vendor ID"},null,512),[[m,o.value.Vendor_ID]])]),t("label",Se,[e[25]||(e[25]=t("span",null,"Vendor Name",-1)),v(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.Vendor_Name=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"Vendor name",required:""},null,512),[[m,o.value.Vendor_Name]])]),t("label",Me,[e[26]||(e[26]=t("span",null,"Vendor Location",-1)),v(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.Vendor_Location=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"Location"},null,512),[[m,o.value.Vendor_Location]])]),t("label",Ae,[e[27]||(e[27]=t("span",null,"Vendor Email",-1)),v(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.Vendor_Email=l),type:"email",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"email@example.com"},null,512),[[m,o.value.Vendor_Email]])]),t("label",Be,[e[28]||(e[28]=t("span",null,"Tin Number",-1)),v(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.Tin_Number=l),type:"text",class:"glass-input w-full px-3 py-2.5 rounded-lg",placeholder:"TIN"},null,512),[[m,o.value.Tin_Number]])])]),t("section",Ge,[e[34]||(e[34]=t("h3",{class:"tax-modal__section-title"},"Dates",-1)),t("div",Ue,[t("label",$e,[e[30]||(e[30]=t("span",null,"GRA Expiry Date",-1)),v(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.GRA_Expiry_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.GRA_Expiry_Date]])]),t("label",Fe,[e[31]||(e[31]=t("span",null,"Received Date",-1)),v(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.Received_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.Received_Date]])])]),t("div",ze,[t("label",je,[e[32]||(e[32]=t("span",null,"WHT Expiry Date",-1)),v(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.WHT_Expiry_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.WHT_Expiry_Date]])]),t("label",qe,[e[33]||(e[33]=t("span",null,"Received WHT Date",-1)),v(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.Received_WHT_Date=l),type:"date",class:"glass-input w-full px-3 py-2.5 rounded-lg"},null,512),[[m,o.value.Received_WHT_Date]])])])]),t("div",Oe,[t("button",{type:"button",class:"tax-modal__btn-cancel",onClick:W}," Cancel "),t("button",{type:"submit",class:"tax-modal__btn-submit",disabled:w.value},d(w.value?"Saving…":c.value?"Save":"Add Vendor"),9,Qe)])],32)],8,Ne)])):y("",!0)]))])}}}),Xe=se(Ye,[["__scopeId","data-v-615ced60"]]);export{Xe as default};
